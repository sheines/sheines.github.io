<!DOCTYPE html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" initial-scale=1.0/>
    <meta name="author" content="Sebastian Hitziger"/>
    <title> Hr. Hitzigers Unterricht </title>
    <link rel="stylesheet" type="text/css" href="/css/grids.css" />
    <link rel="stylesheet" type="text/css" href="/css/styles.css" />
    <link rel="stylesheet" type="text/css" href="/css/book.css" />
</head>
<body>
    <header>
        <h1><a>Hr. Hitzigers Mathematik</a></h1>
    </header>
    <nav>
        Navigation
    </nav>
    <aside>Timeline</aside>
    <main>
        <section class="teaser">
            <svg xmlns="http://www.w3.org/2000/svg" width="500" height="300">
                <!-- Step 1: Draw the x-axis -->
                <line id="xAxis" x1="50" y1="150" x2="450" y2="150" stroke="black" opacity="0" marker-end="url(#xArrowhead)" />
              
                <!-- Step 1: Draw the y-axis -->
                <line id="yAxis" x1="250" y1="250" x2="250" y2="50" stroke="black" opacity="0" marker-end="url(#yArrowhead)" />
              
                <!-- Step 1: Add arrowhead marker for x-axis -->
                <defs>
                  <marker id="xArrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                    <polygon points="0,0 10,5 0,10" fill="black" />
                  </marker>
              
                  <!-- Step 1: Add arrowhead marker for y-axis -->
                  <marker id="yArrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                    <polygon points="0,0 10,5 0,10" fill="black" />
                  </marker>
                </defs>
              
                <!-- Step 2: Draw the graph -->
                <path id="graph" fill="none" stroke="blue" stroke-width="2" opacity="0" clip-path="url(#clip)" />
              
                <!-- Step 3: Mark the zeros of the function -->
                <g id="zeros" opacity="0"></g>

                <!-- Step 4: Move a point along the function graph -->
                <g id="tangentPoint" opacity="0">
                    <circle id="greenDot" r="4" fill="green" cx="0" cy="0" />
                </g>
              
                <defs>
                  <clipPath id="clip">
                    <rect x="50" y="50" width="400" height="200" />
                  </clipPath>
                </defs>
              
               
               
              <script>
                // Step 1: Animate the appearance of the x-axis
                const xAxis = document.getElementById('xAxis');
                xAxis.animate([{ opacity: 0 }, { opacity: 1 }], { duration: 1000, fill: 'forwards' });
              
                // Step 1: Animate the appearance of the y-axis
                const yAxis = document.getElementById('yAxis');
                yAxis.animate([{ opacity: 0 }, { opacity: 1 }], { duration: 1000, fill: 'forwards', delay: 1000 });
              
                // Step 2: Plot the graph after y-axis animation
                setTimeout(() => {
                  const graph = document.getElementById('graph');
                  graph.style.opacity = 1;
                  graph.setAttribute("d", getGraphPath());
                  const pathLength = graph.getTotalLength();
                  graph.style.strokeDasharray = pathLength;
                  graph.style.strokeDashoffset = pathLength;
                  graph.animate([{ strokeDashoffset: pathLength }, { strokeDashoffset: 0 }], { duration: 2000, fill: "forwards" });
              
                  // Step 3: Mark the zeros of the function after graph animation
                  setTimeout(() => {
                    const zeros = document.getElementById('zeros');
                    const xValues = getZeroValues();
                    xValues.forEach((x, index) => {
                      setTimeout(() => {
                        const y = 150 - equation(x) * 10;
                        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                        circle.setAttribute("cx", x * 20 + 250);
                        circle.setAttribute("cy", y);
                        circle.setAttribute("r", "4");
                        circle.setAttribute("fill", "red");
                        zeros.appendChild(circle);
                        circle.style.opacity = 0;
                        circle.animate([{ opacity: 0 }, { opacity: 1 }], { duration: 500, fill: "forwards" });
                        setTimeout(() => {
                          circle.animate([{ opacity: 1 }, { opacity: 0 }], { duration: 500, fill: "forwards" });
                        }, 2000);
                      }, index * 500);
                    });
                    zeros.style.opacity = 1;
                    
                    // Step 4: Move a point along the function graph
                    setTimeout(() => {
                        const tangentPoint = document.getElementById('tangentPoint');
                        const greenDot = document.getElementById('greenDot');
                        tangentPoint.style.opacity = 1;

                        // Find the length of the graph path
                        const graph = document.getElementById('graph');
                        const pathLength = graph.getTotalLength();

                        // Set the initial position of the greenDot to the start of the graph path
                        const initialPoint = graph.getPointAtLength(0);
                        greenDot.setAttribute('cx', initialPoint.x);
                        greenDot.setAttribute('cy', initialPoint.y);

                        // Animate the motion of the greenDot along the graph path
                        let currentTime = null;
                        const duration = 3000; // Animation duration in milliseconds

                        // Create the tangent line element
                        const tangentLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
                        tangentLine.setAttribute("stroke", "limegreen");
                        tangentLine.setAttribute("stroke-width", "2");
                        tangentLine.setAttribute("opacity", "0");
                        tangentPoint.appendChild(tangentLine);

                        // Append the tangent line to the tangentPoint group
                        tangentPoint.appendChild(tangentLine);

                        function animateMotion(timestamp) {
                            if (!currentTime) currentTime = timestamp;
                            const progress = timestamp - currentTime;
                            const fraction = progress / duration;
                            let distance = fraction * pathLength;
                          
                            // Adjust the distance to wrap around the path
                            distance %= pathLength;
                          
                            // Adjust the distance to stop at x = -4
                            const stopX = -4 * 20 + 250; // Convert x-value to coordinate space
                          
                            if (distance >= pathLength && distance % pathLength <= stopX) {
                              distance = stopX;
                            }
                          
                            // Get the x and y coordinates of the green dot
                            const greenDotX = parseFloat(greenDot.getAttribute("cx"));
                            const greenDotY = parseFloat(greenDot.getAttribute("cy"));

                            const point = graph.getPointAtLength(distance);
                            const tangentSlope = derivative((greenDotX - 250) / 20);
                            const tangentLineLength = 50; // Adjust the length of the tangent line as needed

                          
                            // Set the position and slope of the greenDot
                            greenDot.setAttribute("cx", point.x);
                            greenDot.setAttribute("cy", point.y);
                          
                            // Set the position and angle of the tangent line
                            const tangentLineX1 = greenDotX;
                            const tangentLineY1 = greenDotY;
                            const tangentLineX2 = greenDotX + tangentLineLength;
                            const tangentLineY2 = greenDotY - tangentLineLength * tangentSlope;

                            tangentLine.setAttribute("x1", tangentLineX1);
                            tangentLine.setAttribute("y1", tangentLineY1);
                            tangentLine.setAttribute("x2", tangentLineX2);
                            tangentLine.setAttribute("y2", tangentLineY2);
                            tangentLine.style.opacity = 1;

                            if (progress < duration || distance < stopX) {
                              requestAnimationFrame(animateMotion);
                            }
                          }

                        // Start the animation
                        requestAnimationFrame(animateMotion);

                        },3000);
                    }, 2000);
                }, 2000); 
              
                

                function getGraphPath() {
                  let d = "";
                  for (let x = -10; x <= 10; x += 0.1) {
                    const y = 150 - equation(x) * 10;
                    if (y >= 50 && y <= 250) {
                      if (d === "") {
                        d += `M${x * 20 + 250},${y}`;
                      } else {
                        d += ` L${x * 20 + 250},${y}`;
                      }
                    }
                  }
                  return d;
                }
              
                function getZeroValues() {
                  const zeros = [];
                  for (let x = -9.9; x <= 9.9; x += 0.1) {
                    const y1 = equation(x);
                    const y2 = equation(x + 0.1);
                    if (y1 * y2 < 0) {
                      zeros.push(x);
                    }
                  }
                  return zeros;
                }
              
                function markPoint(point, color, parentElement) {
                  const { x, y } = point;
                  const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                  circle.setAttribute("cx", x * 20 + 250);
                  circle.setAttribute("cy", 150 - y * 10);
                  circle.setAttribute("r", "4");
                  circle.setAttribute("fill", color);
                  parentElement.appendChild(circle);
                }
                
                function equation(x) {
                  return (1 / 12) * (Math.pow(x, 3) - 25 * x);
                }
                function derivative(x) {
                    return (1 / 12) * (3 * Math.pow(x, 2) - 25);
                  }
              </script>
            </svg>
              
              
              
              

              
              
              
              
        </section>
        <section>
            <h2>Hier kommt dann der Part zur Mathematik hin.</h2>
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. 
                Libero quidem at cupiditate culpa ipsa illo rerum repudiandae, 
                odit nesciunt, deleniti neque facilis officia iste distinctio 
                iure reiciendis temporibus nihil. Laborum.
            </p>
        </section>

    </main>
    <footer>Fußzeile</footer>
</body>