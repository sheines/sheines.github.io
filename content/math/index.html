<!DOCTYPE html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" initial-scale=1.0/>
    <meta name="author" content="Sebastian Hitziger"/>
    <title> Hr. Hitzigers Unterricht </title>
    <link rel="stylesheet" type="text/css" href="/css/grids.css" />
    <link rel="stylesheet" type="text/css" href="/css/styles.css" />
    <link rel="stylesheet" type="text/css" href="/css/book.css" />
</head>
<body>
    <header>
        <h1><a>Hr. Hitzigers Mathematik</a></h1>
    </header>
    <nav>
        Navigation
    </nav>
    <aside>Timeline</aside>
    <main>
        <section class="teaser">
            <svg xmlns="http://www.w3.org/2000/svg" width="500" height="300">
                <!-- Step 1: Draw the x-axis -->
                <line id="xAxis" x1="50" y1="150" x2="450" y2="150" stroke="black" opacity="0" marker-end="url(#xArrowhead)" />
              
                <!-- Step 1: Draw the y-axis -->
                <line id="yAxis" x1="250" y1="250" x2="250" y2="50" stroke="black" opacity="0" marker-end="url(#yArrowhead)" />
              
                <!-- Step 1: Add arrowhead marker for x-axis -->
                <defs>
                  <marker id="xArrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                    <polygon points="0,0 10,5 0,10" fill="black" />
                  </marker>
              
                  <!-- Step 1: Add arrowhead marker for y-axis -->
                  <marker id="yArrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
                    <polygon points="0,0 10,5 0,10" fill="black" />
                  </marker>
                </defs>
              
                <!-- Step 2: Draw the graph -->
                <path id="graph" fill="none" stroke="blue" stroke-width="2" opacity="0" clip-path="url(#clip)" />
              
                <!-- Step 3: Mark the zeros of the function -->
                <g id="zeros" opacity="0"></g>

                <!-- Step 4: Move a point along the function graph -->
                <g id="tangentPoint" opacity="0">
                    <circle id="greenDot" r="4" fill="green" cx="0" cy="0" />
                </g>
              
                <defs>
                  <clipPath id="clip">
                    <rect x="50" y="50" width="400" height="200" />
                  </clipPath>
                </defs>
              
               
               
              <script>
                // Step 1: Animate the appearance of the x-axis
                const xAxis = document.getElementById('xAxis');
                xAxis.animate([{ opacity: 0 }, { opacity: 1 }], { duration: 1000, fill: 'forwards' });

                // Step 1: Animate the appearance of the y-axis
                const yAxis = document.getElementById('yAxis');
                yAxis.animate([{ opacity: 0 }, { opacity: 1 }], { duration: 1000, fill: 'forwards', delay: 1000 });

                // Step 2: Plot the graph after y-axis animation
                setTimeout(() => {
                    const graph = document.getElementById('graph');
                    graph.style.opacity = 1;
                    graph.setAttribute("d", getGraphPath());
                    const pathLength = graph.getTotalLength();
                    graph.style.strokeDasharray = pathLength;
                    graph.style.strokeDashoffset = pathLength;
                    graph.animate([{ strokeDashoffset: pathLength }, { strokeDashoffset: 0 }], { duration: 2000, fill: "forwards" });

                    // Step 3: Mark the zeros of the function after graph animation
                    setTimeout(() => {
                    const zeros = document.getElementById('zeros');
                    const xValues = getZeroValues();
                    xValues.forEach((x, index) => {
                        setTimeout(() => {
                        const y = equation(x);
                        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                        circle.setAttribute("cx", getSvgX(x));
                        circle.setAttribute("cy", getSvgY(y));
                        circle.setAttribute("r", "4");
                        circle.setAttribute("fill", "red");
                        zeros.appendChild(circle);
                        circle.style.opacity = 0;
                        circle.animate([{ opacity: 0 }, { opacity: 1 }], { duration: 500, fill: "forwards" });
                        setTimeout(() => {
                            circle.animate([{ opacity: 1 }, { opacity: 0 }], { duration: 500, fill: "forwards" });
                        }, 2000);
                        }, index * 500);
                    });
                    zeros.style.opacity = 1;
                    

                    // Step 4: Animate the motion of the tangentPoint along the graph path
                    setTimeout(() => {
                        const tangentPoint = document.getElementById('tangentPoint');
    const greenDot = document.createElementNS("http://www.w3.org/2000/svg", "circle");
    greenDot.setAttribute("id", "greenDot");
    greenDot.setAttribute("r", "4");
    greenDot.setAttribute("fill", "green");
    tangentPoint.appendChild(greenDot);
    tangentPoint.style.opacity = 1;

    const tangentLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
    tangentLine.setAttribute("x1", 0);
    tangentLine.setAttribute("y1", 0);
    tangentLine.setAttribute("x2", 0);
    tangentLine.setAttribute("y2", 0);
    tangentLine.setAttribute("stroke", "limegreen");
    tangentLine.setAttribute("stroke-width", "2");
    tangentLine.style.opacity = 0;
    tangentPoint.appendChild(tangentLine);

    const pathLengthTangent = graph.getTotalLength();

    function moveTangentPoint() {
      const greenDotX = leftmostPoint.x; // Subtract the x offset
      const greenDotY = equation(getFuncX(greenDotX)); // Adjust the vertical offset as needed

      const tangentSlope = derivative(getFuncX(greenDotX));
      const tangentLineLength = 100; // Adjust the length of the tangent line as needed
      const tangentLineX1 = greenDotX - (tangentLineLength / Math.sqrt(1 + Math.pow(tangentSlope, 2)));
      const tangentLineY1 = greenDotY - (tangentLineLength * tangentSlope) / Math.sqrt(1 + Math.pow(tangentSlope, 2));
      const tangentLineX2 = greenDotX + (tangentLineLength / Math.sqrt(1 + Math.pow(tangentSlope, 2)));
      const tangentLineY2 = greenDotY + (tangentLineLength * tangentSlope) / Math.sqrt(1 + Math.pow(tangentSlope, 2));

      greenDot.setAttribute("cx", getSvgX(greenDotX));
      greenDot.setAttribute("cy", getSvgY(greenDotY));
      tangentLine.setAttribute("x1", getSvgX(tangentLineX1));
      tangentLine.setAttribute("y1", getSvgY(tangentLineY1));
      tangentLine.setAttribute("x2", getSvgX(tangentLineX2));
      tangentLine.setAttribute("y2", getSvgY(tangentLineY2));

      const animationDuration = 3000; // Animation duration in milliseconds

      function animateMotion(timestamp) {
        if (!currentTime) currentTime = timestamp;
        const progress = timestamp - currentTime;
        const fraction = progress / animationDuration;
        let distance = fraction * pathLengthTangent;

        // Adjust the distance to wrap around the path
        distance %= pathLengthTangent;

        // Adjust the distance to stop at x = -4
        const stopX = getSvgX(-4); // Convert x-value to coordinate space

        if (distance >= pathLengthTangent && distance % pathLengthTangent <= stopX) {
          distance = stopX;
        }

        const point = graph.getPointAtLength(distance);

        // Set the position of the greenDot
        greenDot.setAttribute('cx', point.x);
        greenDot.setAttribute('cy', point.y);

        // Set the position of the tangent line
        const tangentSlope = derivative(getFuncX(getFuncX(point.x)));
        const tangentLineLength = 100; // Adjust the length of the tangent line as needed
        const tangentLineX1 = point.x - (tangentLineLength / Math.sqrt(1 + Math.pow(tangentSlope, 2)));
        const tangentLineY1 = getFuncY(equation(getFuncX(tangentLineX1)));
        const tangentLineX2 = point.x + (tangentLineLength / Math.sqrt(1 + Math.pow(tangentSlope, 2)));
        const tangentLineY2 = getFuncY(equation(getFuncX(tangentLineX2)));

        tangentLine.setAttribute("x1", tangentLineX1);
        tangentLine.setAttribute("y1", tangentLineY1);
        tangentLine.setAttribute("x2", tangentLineX2);
        tangentLine.setAttribute("y2", tangentLineY2);

        if (progress < animationDuration || distance < stopX) {
          requestAnimationFrame(animateMotion);
        }
      }

      // Start the animation
      let currentTime = null;
      requestAnimationFrame(animateMotion);
    }

    moveTangentPoint();
                        }, 4000);
                    }, 3000);
                }, 2000);
              
                

                function getGraphPath() {
                  let d = "";
                  for (let x = -10; x <= 10; x += 0.1) {
                    const y = getSvgY(equation(x));
                    if (y >= 50 && y <= 250) {
                      if (d === "") {
                        d += `M${getSvgX(x)},${y}`;
                      } else {
                        d += ` L${getSvgX(x)},${y}`;
                      }
                    }
                  }
                  return d;
                }
              
                function getZeroValues() {
                  const zeros = [];
                  for (let x = -9.9; x <= 9.9; x += 0.1) {
                    const y1 = equation(x);
                    const y2 = equation(x + 0.1);
                    if (y1 * y2 < 0) {
                      zeros.push(x);
                    }
                  }
                  return zeros;
                }
              
                function markPoint(point, color, parentElement) {
                  const { x, y } = point;
                  const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                  circle.setAttribute("cx", getSvgX(x));
                  circle.setAttribute("cy", getSvgY(y));
                  circle.setAttribute("r", "4");
                  circle.setAttribute("fill", color);
                  parentElement.appendChild(circle);
                }
                function getSvgX(x) {
                    return x * 20 + 250;
                }
                function getSvgY(y) {
                    return 150 - y * 10;
                }
                function getFuncX(x) {
                    return (x - 250) / 20;
                }
                function getFuncY(y) {
                    return (150 - y) / 10;
                }
                function equation(x) { 
                  return (1 / 12) * (Math.pow(x, 3) - 25 * x);
                }
                function derivative(x) {
                    return (1 / 12) * (3 * Math.pow(x, 2) - 25);
                  }
              </script>
            </svg>
              
              
              
              

              
              
              
              
        </section>
        <section>
            <h2>Hier kommt dann der Part zur Mathematik hin.</h2>
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. 
                Libero quidem at cupiditate culpa ipsa illo rerum repudiandae, 
                odit nesciunt, deleniti neque facilis officia iste distinctio 
                iure reiciendis temporibus nihil. Laborum.
            </p>
        </section>

    </main>
    <footer>Fußzeile</footer>
</body>